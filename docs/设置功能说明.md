# 设置功能说明

## 概述

本次更新完善了"我的"页面，新增了完整的设置界面，包括通知设置、数据管理、应用设置和用户信息编辑等功能。

## 新增功能

### 1. 设置页面 (SettingsActivity)

#### 通知设置
- **训练提醒**：可开启/关闭每日训练提醒，支持自定义提醒时间
- **饮水提醒**：每2小时提醒一次饮水
- **睡眠提醒**：可设置睡眠时间提醒

#### 数据管理
- **数据同步**：同步数据到云端备份
- **数据导出**：支持导出训练记录、饮食记录、身体数据或全部数据
- **数据重置**：清除所有训练记录（需二次确认）

#### 应用设置
- **深色模式**：切换护眼深色主题
- **语言设置**：支持中文/英文切换
- **清除缓存**：清理临时文件

#### 关于
- **关于应用**：显示应用版本和介绍
- **隐私政策**：数据保护与隐私说明
- **意见反馈**：用户反馈渠道

### 2. 用户信息编辑页面 (UserProfileActivity)

- **个人信息编辑**：姓名、身高、性别、年龄、健身目标
- **头像更换**：支持更换用户头像（预留功能）
- **实时保存**：修改后立即保存到数据库

### 3. 数据模型

#### AppSettings
```kotlin
data class AppSettings(
    // 通知设置
    val trainingReminderEnabled: Boolean = true,
    val trainingReminderTime: String = "18:00",
    val waterReminderEnabled: Boolean = true,
    val sleepReminderEnabled: Boolean = true,
    val sleepReminderTime: String = "22:00",
    
    // 应用设置
    val darkModeEnabled: Boolean = false,
    val language: String = "zh",
    
    // 用户信息
    val userName: String = "燃力用户",
    val userHeight: Float = 170f,
    val userGender: String = "male",
    val userAge: Int = 25,
    val userGoal: String = "减脂塑形"
)
```

### 4. 数据库更新

- 新增 `app_settings` 表
- 新增 `AppSettingsDao` 数据访问对象
- 数据库版本升级到 v2

## 技术实现

### 架构模式
- **MVVM架构**：使用ViewModel管理UI状态
- **Repository模式**：统一数据访问接口
- **Room数据库**：本地数据持久化

### 关键组件

1. **SettingsViewModel**
   - 管理设置状态
   - 处理用户操作
   - 提供数据绑定

2. **AppSettingsDao**
   - 数据库操作接口
   - 支持增删改查
   - 提供Flow响应式数据流

3. **Fit8Repository**
   - 统一数据访问
   - 封装业务逻辑
   - 提供设置相关方法

### UI设计

- **Material Design 3**：遵循最新设计规范
- **卡片布局**：清晰的信息分组
- **开关控件**：直观的设置开关
- **对话框**：友好的交互体验

## 使用方法

### 访问设置页面
1. 点击底部导航"我的"标签
2. 点击"设置"选项
3. 进入设置页面

### 编辑个人信息
1. 在"我的"页面点击用户信息卡片
2. 点击"编辑"按钮
3. 进入个人信息编辑页面

### 设置通知提醒
1. 进入设置页面
2. 在"通知设置"区域开启相应提醒
3. 点击时间设置自定义提醒时间

## 测试

### 单元测试
- `SettingsViewModelTest`：测试ViewModel逻辑
- 覆盖主要业务场景
- 使用MockK进行依赖注入

### 功能测试
1. 设置开关功能
2. 时间选择器
3. 数据持久化
4. 用户信息编辑

## 后续优化

### 计划功能
1. **云端同步**：实现真实的数据同步功能
2. **数据导出**：支持Excel/CSV格式导出
3. **主题切换**：完整的深色模式支持
4. **多语言**：完整的国际化支持
5. **头像上传**：支持拍照和相册选择

### 性能优化
1. 设置数据缓存
2. 异步加载优化
3. 内存使用优化

## 注意事项

1. **数据重置**：此操作不可逆，需谨慎使用
2. **权限申请**：通知功能需要通知权限
3. **版本兼容**：数据库升级需要处理版本兼容
4. **用户体验**：所有操作都有相应的反馈提示

## 总结

本次更新大幅提升了应用的用户体验，提供了完整的设置功能。用户可以根据个人喜好自定义应用行为，管理个人数据，享受更加个性化的健身体验。
